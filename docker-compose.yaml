services:
  # GitHub MCP Server
  github-mcp:
    image: ghcr.io/github/github-mcp-server:latest
    container_name: github-mcp-server
    stdin_open: true
    tty: false
    environment:
      - GITHUB_PERSONAL_ACCESS_TOKEN=${GITHUB_PERSONAL_ACCESS_TOKEN}
      - GITHUB_TOOLSETS=repos,issues,pull_requests,actions,code_security,experiments
      - LOG_LEVEL=${GITHUB_MCP_LOG_LEVEL:-info}
    restart: unless-stopped
    networks:
      - mcp-network
    healthcheck:
      test: ["CMD", "ps", "aux"]
      interval: 30s
      timeout: 10s
      retries: 3
      start_period: 10s

  # Docker Hub MCP Server  
  dockerhub-mcp:
    image: mcp/dockerhub:latest
    container_name: dockerhub-mcp-server
    stdin_open: true
    tty: false
    environment:
      - HUB_PAT_TOKEN=${HUB_PAT_TOKEN}
    command: ["--transport=stdio", "--username=${DOCKERHUB_USERNAME}"]
    restart: unless-stopped
    networks:
      - mcp-network
    healthcheck:
      test: ["CMD", "ps", "aux"]
      interval: 30s
      timeout: 10s
      retries: 3
      start_period: 10s

  # Memory MCP Server
  memory-mcp:
    image: mcp/memory:latest
    container_name: memory-mcp-server
    stdin_open: true
    tty: false
    restart: unless-stopped
    networks:
      - mcp-network
    healthcheck:
      test: ["CMD", "ps", "aux"]
      interval: 30s
      timeout: 10s
      retries: 3
      start_period: 10s

  # Context7 MCP Server
  context7-mcp:
    image: mcp/context7:latest
    container_name: context7-mcp-server
    stdin_open: true
    tty: false
    restart: unless-stopped
    networks:
      - mcp-network
    healthcheck:
      test: ["CMD", "ps", "aux"]
      interval: 30s
      timeout: 10s
      retries: 3
      start_period: 10s

  # Bitbucket MCP Server (Custom Build)
  bitbucket-mcp:
    build:
      context: ./dockerized/bitbucket-mcp
      dockerfile: Dockerfile
    container_name: bitbucket-mcp-server
    stdin_open: true
    tty: false
    environment:
      - ATLASSIAN_BITBUCKET_USERNAME=${BITBUCKET_USERNAME}
      - ATLASSIAN_BITBUCKET_APP_PASSWORD=${BITBUCKET_APP_PASSWORD}
      - BITBUCKET_DEFAULT_WORKSPACE=${BITBUCKET_DEFAULT_WORKSPACE}
    restart: unless-stopped
    networks:
      - mcp-network
    healthcheck:
      test: ["CMD", "ps", "aux"]
      interval: 30s
      timeout: 10s
      retries: 3
      start_period: 10s

networks:
  mcp-network:
    driver: bridge